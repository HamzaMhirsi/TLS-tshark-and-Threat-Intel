import re
from OpenSSL.crypto import FILETYPE_PEM
from OpenSSL.crypto import (
    FILETYPE_ASN1, X509Store, X509StoreContext, X509StoreContextError,
    load_certificate)

d="19-03-26,19-06-18,17-06-15,21-12-15"
c="30:82:0a:66:30:82:09:4e:a0:03:02:01:02:02:10:59:d7:78:4a:cc:fb:3e:59:cb:38:aa:74:ce:95:46:01:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:30:54:31:0b:30:09:06:03:55:04:06:13:02:55:53:31:1e:30:1c:06:03:55:04:0a:13:15:47:6f:6f:67:6c:65:20:54:72:75:73:74:20:53:65:72:76:69:63:65:73:31:25:30:23:06:03:55:04:03:13:1c:47:6f:6f:67:6c:65:20:49:6e:74:65:72:6e:65:74:20:41:75:74:68:6f:72:69:74:79:20:47:33:30:1e:17:0d:31:39:30:33:32:36:31:33:34:31:31:31:5a:17:0d:31:39:30:36:31:38:31:33:32:34:30:30:5a:30:71:31:0b:30:09:06:03:55:04:06:13:02:55:53:31:13:30:11:06:03:55:04:08:0c:0a:43:61:6c:69:66:6f:72:6e:69:61:31:16:30:14:06:03:55:04:07:0c:0d:4d:6f:75:6e:74:61:69:6e:20:56:69:65:77:31:13:30:11:06:03:55:04:0a:0c:0a:47:6f:6f:67:6c:65:20:4c:4c:43:31:20:30:1e:06:03:55:04:03:0c:17:2a:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:30:59:30:13:06:07:2a:86:48:ce:3d:02:01:06:08:2a:86:48:ce:3d:03:01:07:03:42:00:04:5c:fb:39:5e:c2:77:f5:19:af:32:5b:6b:99:a4:3c:66:72:07:08:1f:d1:07:d9:08:c2:88:40:d2:81:5a:ff:77:bc:b0:fe:4f:c1:de:c3:7f:fd:28:7d:87:a8:23:76:85:88:fb:e3:96:18:8c:5e:02:74:70:8a:94:9a:1a:80:b5:a3:82:07:e0:30:82:07:dc:30:13:06:03:55:1d:25:04:0c:30:0a:06:08:2b:06:01:05:05:07:03:01:30:0e:06:03:55:1d:0f:01:01:ff:04:04:03:02:07:80:30:82:06:a5:06:03:55:1d:11:04:82:06:9c:30:82:06:98:82:17:2a:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:1c:2a:2e:61:70:70:73:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:24:2a:2e:61:70:70:73:70:6f:74:2e:63:6f:6d:2e:73:74:6f:72:61:67:65:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:3d:2a:2e:61:75:64:69:6f:62:6f:6f:6b:2d:61:64:64:69:74:69:6f:6e:61:6c:2d:6d:61:74:65:72:69:61:6c:2d:73:74:61:67:69:6e:67:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:35:2a:2e:61:75:64:69:6f:62:6f:6f:6b:2d:61:64:64:69:74:69:6f:6e:61:6c:2d:6d:61:74:65:72:69:61:6c:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:0e:2a:2e:62:6c:6f:67:73:70:6f:74:2e:63:6f:6d:82:11:2a:2e:62:70:2e:62:6c:6f:67:73:70:6f:74:2e:63:6f:6d:82:22:2a:2e:63:6f:6d:6d:6f:6e:64:61:74:61:73:74:6f:72:61:67:65:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:29:2a:2e:63:6f:6e:74:65:6e:74:2d:73:74:6f:72:61:67:65:2d:64:6f:77:6e:6c:6f:61:64:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:27:2a:2e:63:6f:6e:74:65:6e:74:2d:73:74:6f:72:61:67:65:2d:75:70:6c:6f:61:64:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:20:2a:2e:63:6f:6e:74:65:6e:74:2d:73:74:6f:72:61:67:65:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:28:2a:2e:64:61:74:61:70:72:6f:63:2d:73:74:61:67:69:6e:67:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:2a:2e:64:61:74:61:70:72:6f:63:2d:74:65:73:74:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:20:2a:2e:64:61:74:61:70:72:6f:63:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:24:2a:2e:64:65:76:2e:61:6d:70:34:6d:61:69:6c:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:1c:2a:2e:64:6f:75:62:6c:65:63:6c:69:63:6b:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:0b:2a:2e:67:67:70:68:74:2e:63:6f:6d:82:11:2a:2e:67:6f:6f:67:6c:65:64:72:69:76:65:2e:63:6f:6d:82:17:2a:2e:67:6f:6f:67:6c:65:73:79:6e:64:69:63:61:74:69:6f:6e:2e:63:6f:6d:82:14:2a:2e:67:6f:6f:67:6c:65:77:65:62:6c:69:67:68:74:2e:63:6f:6d:82:34:2a:2e:70:6c:61:79:67:72:6f:75:6e:64:2d:69:6e:74:65:72:6e:61:6c:2e:61:6d:70:34:6d:61:69:6c:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:2b:2a:2e:70:6c:61:79:67:72:6f:75:6e:64:2e:61:6d:70:34:6d:61:69:6c:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:2a:2e:70:72:6f:64:2e:61:6d:70:34:6d:61:69:6c:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:1f:2a:2e:73:61:66:65:6e:75:70:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:1f:2a:2e:73:61:6e:64:62:6f:78:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:21:2a:2e:73:74:6f:72:61:67:65:2d:64:6f:77:6e:6c:6f:61:64:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:1f:2a:2e:73:74:6f:72:61:67:65:2d:75:70:6c:6f:61:64:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:18:2a:2e:73:74:6f:72:61:67:65:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:1f:2a:2e:73:74:6f:72:61:67:65:2e:73:65:6c:65:63:74:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:10:2a:2e:74:72:61:6e:73:6c:61:74:65:2e:67:6f:6f:67:82:0c:62:6c:6f:67:73:70:6f:74:2e:63:6f:6d:82:0f:62:70:2e:62:6c:6f:67:73:70:6f:74:2e:63:6f:6d:82:20:63:6f:6d:6d:6f:6e:64:61:74:61:73:74:6f:72:61:67:65:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:1a:64:6f:75:62:6c:65:63:6c:69:63:6b:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:09:67:67:70:68:74:2e:63:6f:6d:82:0f:67:6f:6f:67:6c:65:64:72:69:76:65:2e:63:6f:6d:82:15:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:12:67:6f:6f:67:6c:65:77:65:62:6c:69:67:68:74:2e:63:6f:6d:82:25:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2d:64:61:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2d:64:62:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2d:64:63:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2d:64:64:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2d:64:65:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2d:64:66:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2d:64:67:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:25:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2d:64:7a:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:22:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2e:67:6f:6f:67:6c:65:75:73:65:72:63:6f:6e:74:65:6e:74:2e:63:6f:6d:82:1e:6d:61:6e:69:66:65:73:74:2e:6c:68:33:2e:70:68:6f:74:6f:73:2e:67:6f:6f:67:6c:65:2e:63:6f:6d:82:2b:73:74:61:74:69:63:2e:70:61:6e:6f:72:61:6d:69:6f:2e:63:6f:6d:2e:73:74:6f:72:61:67:65:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:16:73:74:6f:72:61:67:65:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:1d:73:74:6f:72:61:67:65:2e:73:65:6c:65:63:74:2e:67:6f:6f:67:6c:65:61:70:69:73:2e:63:6f:6d:82:0e:74:72:61:6e:73:6c:61:74:65:2e:67:6f:6f:67:82:0f:75:6e:66:69:6c:74:65:72:65:64:2e:6e:65:77:73:30:68:06:08:2b:06:01:05:05:07:01:01:04:5c:30:5a:30:2d:06:08:2b:06:01:05:05:07:30:02:86:21:68:74:74:70:3a:2f:2f:70:6b:69:2e:67:6f:6f:67:2f:67:73:72:32:2f:47:54:53:47:49:41:47:33:2e:63:72:74:30:29:06:08:2b:06:01:05:05:07:30:01:86:1d:68:74:74:70:3a:2f:2f:6f:63:73:70:2e:70:6b:69:2e:67:6f:6f:67:2f:47:54:53:47:49:41:47:33:30:1d:06:03:55:1d:0e:04:16:04:14:ff:f0:1f:01:b3:49:e0:d4:05:9a:3f:9e:03:15:15:28:ab:23:d1:8b:30:0c:06:03:55:1d:13:01:01:ff:04:02:30:00:30:1f:06:03:55:1d:23:04:18:30:16:80:14:77:c2:b8:50:9a:67:76:76:b1:2d:c2:86:d0:83:a0:7e:a6:7e:ba:4b:30:21:06:03:55:1d:20:04:1a:30:18:30:0c:06:0a:2b:06:01:04:01:d6:79:02:05:03:30:08:06:06:67:81:0c:01:02:02:30:31:06:03:55:1d:1f:04:2a:30:28:30:26:a0:24:a0:22:86:20:68:74:74:70:3a:2f:2f:63:72:6c:2e:70:6b:69:2e:67:6f:6f:67:2f:47:54:53:47:49:41:47:33:2e:63:72:6c:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:03:82:01:01:00:83:3d:01:3a:09:37:34:ab:c7:6b:a9:5d:c7:aa:2f:64:41:ed:fc:ff:48:1f:f7:b2:85:ad:64:dc:f5:12:b4:41:86:5c:2f:55:82:9c:a1:11:6a:d0:51:b9:de:ab:18:23:e9:b7:26:8f:cf:e5:cb:db:72:a9:4c:5a:56:0d:99:ad:a5:ff:bf:ff:e1:bf:c1:b8:48:e1:65:e8:f5:51:b4:8c:cb:1c:18:5c:0b:db:b7:b3:af:7e:b8:61:00:27:dc:48:2d:69:2e:45:f1:98:90:48:d3:e5:80:52:1b:df:d6:1f:ed:84:db:18:af:e0:5f:c7:ab:1b:99:95:7c:9b:91:e6:7d:8f:5f:72:7f:cf:0f:1f:97:d3:76:e8:40:b2:4a:40:26:23:3c:6d:80:8a:fb:83:5c:75:6f:f1:b2:ed:d7:76:bd:59:11:e4:cc:e3:c9:61:21:82:1b:fd:95:cd:c0:e8:90:eb:92:34:17:a3:cd:4c:f7:fc:9d:68:a2:91:63:37:4e:ad:70:60:84:79:a1:69:cc:e5:63:86:19:64:18:48:ca:cc:e0:c9:f8:8c:e9:7c:18:7e:50:e1:88:5c:bd:94:53:00:15:f4:74:b6:1c:e9:78:97:fd:7b:4b:d0:32:6b:51:9c:de:a5:bb:3a:e4:82:e7:60:02:06:e6:87:7c:0f,30:82:04:5c:30:82:03:44:a0:03:02:01:02:02:0d:01:e3:a9:30:1c:fc:72:06:38:3f:9a:53:1d:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:30:4c:31:20:30:1e:06:03:55:04:0b:13:17:47:6c:6f:62:61:6c:53:69:67:6e:20:52:6f:6f:74:20:43:41:20:2d:20:52:32:31:13:30:11:06:03:55:04:0a:13:0a:47:6c:6f:62:61:6c:53:69:67:6e:31:13:30:11:06:03:55:04:03:13:0a:47:6c:6f:62:61:6c:53:69:67:6e:30:1e:17:0d:31:37:30:36:31:35:30:30:30:30:34:32:5a:17:0d:32:31:31:32:31:35:30:30:30:30:34:32:5a:30:54:31:0b:30:09:06:03:55:04:06:13:02:55:53:31:1e:30:1c:06:03:55:04:0a:13:15:47:6f:6f:67:6c:65:20:54:72:75:73:74:20:53:65:72:76:69:63:65:73:31:25:30:23:06:03:55:04:03:13:1c:47:6f:6f:67:6c:65:20:49:6e:74:65:72:6e:65:74:20:41:75:74:68:6f:72:69:74:79:20:47:33:30:82:01:22:30:0d:06:09:2a:86:48:86:f7:0d:01:01:01:05:00:03:82:01:0f:00:30:82:01:0a:02:82:01:01:00:ca:52:4b:ea:1e:ff:ce:24:6b:a8:da:72:18:68:d5:56:5d:0e:48:5a:2d:35:09:76:5a:cf:a4:c8:1c:b1:a9:fe:53:89:fb:ad:34:ff:88:5b:9f:bb:e7:e8:00:01:dc:35:73:75:03:ad:b3:b1:b9:a4:7d:2b:26:79:ce:15:40:0a:ef:51:b8:9f:32:8c:7c:70:86:52:4b:16:fe:6a:27:6b:e6:36:7a:62:50:d8:df:9a:89:cc:09:29:eb:4f:29:14:88:80:0b:8f:38:1e:80:6a:18:7c:1d:bd:97:3b:78:7d:45:49:36:4f:41:cd:a2:e0:76:57:3c:68:31:79:64:c9:6e:d7:51:1e:66:c3:a2:64:2c:79:c0:e7:65:c3:56:84:53:5a:43:6d:cb:9a:02:20:d2:ef:1a:69:d1:b0:9d:73:a2:e0:2a:60:65:50:31:cf:fb:b3:2f:bf:11:88:40:2e:b5:49:10:0f:0a:6e:dc:97:fa:bf:2c:9f:05:39:0b:58:54:af:06:96:e8:c5:8e:01:16:bc:a8:1a:4d:41:c5:93:91:a2:1e:a1:8b:f2:fe:c1:88:24:49:a3:47:4b:c5:13:01:dd:a7:57:12:69:62:2b:eb:fe:20:ef:69:fb:3a:a5:f0:7e:29:ee:ed:96:16:f7:b1:1f:a0:e4:90:25:e0:33:02:03:01:00:01:a3:82:01:33:30:82:01:2f:30:0e:06:03:55:1d:0f:01:01:ff:04:04:03:02:01:86:30:1d:06:03:55:1d:25:04:16:30:14:06:08:2b:06:01:05:05:07:03:01:06:08:2b:06:01:05:05:07:03:02:30:12:06:03:55:1d:13:01:01:ff:04:08:30:06:01:01:ff:02:01:00:30:1d:06:03:55:1d:0e:04:16:04:14:77:c2:b8:50:9a:67:76:76:b1:2d:c2:86:d0:83:a0:7e:a6:7e:ba:4b:30:1f:06:03:55:1d:23:04:18:30:16:80:14:9b:e2:07:57:67:1c:1e:c0:6a:06:de:59:b4:9a:2d:df:dc:19:86:2e:30:35:06:08:2b:06:01:05:05:07:01:01:04:29:30:27:30:25:06:08:2b:06:01:05:05:07:30:01:86:19:68:74:74:70:3a:2f:2f:6f:63:73:70:2e:70:6b:69:2e:67:6f:6f:67:2f:67:73:72:32:30:32:06:03:55:1d:1f:04:2b:30:29:30:27:a0:25:a0:23:86:21:68:74:74:70:3a:2f:2f:63:72:6c:2e:70:6b:69:2e:67:6f:6f:67:2f:67:73:72:32:2f:67:73:72:32:2e:63:72:6c:30:3f:06:03:55:1d:20:04:38:30:36:30:34:06:06:67:81:0c:01:02:02:30:2a:30:28:06:08:2b:06:01:05:05:07:02:01:16:1c:68:74:74:70:73:3a:2f:2f:70:6b:69:2e:67:6f:6f:67:2f:72:65:70:6f:73:69:74:6f:72:79:2f:30:0d:06:09:2a:86:48:86:f7:0d:01:01:0b:05:00:03:82:01:01:00:1c:b7:89:96:e4:53:ed:bb:ec:db:a8:32:01:9f:2c:a3:cd:6d:ad:42:12:77:b3:b8:e6:c9:03:52:60:20:7b:57:27:c6:11:b5:3f:67:0d:99:2c:5b:5a:ca:22:0a:dd:9e:bb:1f:4b:48:3f:8f:02:3d:8b:21:84:45:1d:6d:f5:ff:ac:68:89:cd:64:e2:d6:d6:5e:40:c2:8e:2a:f7:ef:14:d3:36:a4:40:30:f5:32:15:15:92:76:fb:7e:9e:53:ea:c2:76:fc:39:ad:88:fe:66:92:26:e9:1c:c4:38:cd:49:fa:43:87:f0:5d:d6:56:4d:81:d7:7f:f1:c2:dd:b0:4d:fe:c3:2a:6e:7c:9f:6e:5c:ed:62:42:99:e1:f7:36:ee:14:8c:2c:20:e3:46:97:5a:77:03:c0:a0:c6:4a:88:fd:40:22:87:72:5a:18:ea:9c:a5:c7:5a:08:8c:e4:05:a4:7d:b9:84:35:5f:89:36:56:0e:40:3d:12:e8:bb:35:72:ed:af:08:56:4e:b0:bb:2e:a9:9b:e4:fb:1d:3e:0b:63:c8:9b:4b:91:44:66:57:c0:14:b4:96:f0:dc:2c:57:3f:52:04:ad:95:aa:7d:4d:d0:f2:0c:9f:9c:40:e8:d6:55:73:ba:3c:df:90:cb:00:5b:21:11:67:c2:ed:32:1e:de"
c1=c.split(',')
d1=d.split(',')
date=[]
i=0
#print len(d1)
while i < len(d1):
	if i % 2 == 0:
		date.append(d1[i])
	i+=1

max_date=date[0]

def tri_bulle(tableau):
    permutation = True
    passage = 0
    while permutation == True:
        permutation = False
        passage = passage + 1
        for en_cours in range(0, len(tableau) - passage):
            if tableau[en_cours] < tableau[en_cours + 1]:
                permutation = True
                # On echange les deux elements
                tableau[en_cours], tableau[en_cours + 1] = \
                tableau[en_cours + 1],tableau[en_cours]
                c1[en_cours], c1[en_cours + 1] = \
                c1[en_cours + 1],c1[en_cours]
    return tableau 

def get_issuer(cert):
    try:
        names = cert.issuer.get_attributes_for_oid(NameOID.COMMON_NAME)
        return names[0].value
    except x509.ExtensionNotFound:
        return None

def get_common_name_from_components(self, obj):
        return dict(obj.get_components())[b'CN'].decode('utf-8')

def get_issuer_common_name(certificate):
        return get_common_name_from_components(certificate._x509.get_issuer())

for cert in c1:
		a=str(cert).replace(":","")
		b = a.decode("Hex").encode("Base64")
		certificate = "-----BEGIN CERTIFICATE-----\n" + b + "-----END CERTIFICATE-----"
		cert = load_certificate(FILETYPE_PEM, certificate)
		#issuer_cert = x509.load_pem_x509_certificate(certificate, default_backend())
		#print (issuer_cert)
#		issuer_subject = issuer_cert.extensions.get_extension_for_class(x509.SubjectKeyIdentifier)
#		print issuer_subject
		common_name = cert.get_subject().commonName.decode()
		print (common_name)